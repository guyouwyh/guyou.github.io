<!-- build time:Sat Apr 02 2022 17:09:47 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><link rel="mask-icon" href="/images/logo.svg" color=""><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="努力走,走到灯火通明" href="https://guyouwyh.github.io/guyouwyh/rss.xml"><link rel="alternate" type="application/atom+xml" title="努力走,走到灯火通明" href="https://guyouwyh.github.io/guyouwyh/atom.xml"><link rel="alternate" type="application/json" title="努力走,走到灯火通明" href="https://guyouwyh.github.io/guyouwyh/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="框架"><link rel="canonical" href="https://guyouwyh.github.io/guyouwyh/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/Springboot%E7%AC%94%E8%AE%B0/"><title>Springboot2.x笔记 - Spring框架 - 后端 | GuYou = 努力走,走到灯火通明</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Springboot2.x笔记</h1><div class="meta"><span class="item" title="创建时间：2021-10-21 21:00:37"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-10-21T21:00:37+08:00">2021-10-21</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>12k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>11 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">GuYou</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://s2.loli.net/2021/12/15/fqp9bDFPBEIHCz5.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2021/12/15/8KdoJ6jO7mLCDUu.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2021/12/15/7E2sYl8uZARyLqh.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2021/12/15/IJoXjhzGPOQdi9c.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2021/12/15/sE4YZtNxHrPTG8c.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2021/12/15/kwmo6aiQbGenNqs.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="item" rel="index" title="分类于 后端"><span itemprop="name">后端</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/" itemprop="item" rel="index" title="分类于 Spring框架"><span itemprop="name">Spring框架</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://guyouwyh.github.io/guyouwyh/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/Springboot%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="故犹"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="努力走,走到灯火通明"></span><div class="body md" itemprop="articleBody"><h1 id="底层注解"><a class="anchor" href="#底层注解">#</a> 底层注解</h1><blockquote><h2 id="configuration"><a class="anchor" href="#configuration">#</a> <strong>@Configuration</strong></h2></blockquote><p><strong>用在类上，表名是一个配置类，类似于 xml 文件</strong></p><p><strong>参数:</strong></p><p><strong>proxyBeanMethods</strong></p><p><strong>代理 bean 的方法.</strong></p><p><strong>Full (proxyBeanMethods = true)【保证每个 @Bean 方法被调用多少次返回的组件都是单实例的】</strong></p><p><strong>Lite (proxyBeanMethods = false)【每个 @Bean 方法被调用多少次返回的组件都是新创建的】</strong></p><p><strong>组件依赖必须使用 Full 模式默认。其他默认是否 Lite 模式</strong></p><blockquote><h2 id="bean"><a class="anchor" href="#bean">#</a> <strong>Bean</strong></h2></blockquote><p><strong>在 spring 容器中创建 bean</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Bean</span> <span class="token comment">// 给容器中添加组件。以方法名作为组件的 id。返回类型就是组件类型。返回的值，就是组件在容器中的实例</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">user01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token class-name">User</span> zhangsan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"zhangsan"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token comment">//user 组件依赖了 Pet 组件</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        zhangsan<span class="token punctuation">.</span><span class="token function">setPet</span><span class="token punctuation">(</span><span class="token function">tomcatPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">return</span> zhangsan<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><h2 id="import"><a class="anchor" href="#import">#</a> <strong>@Import</strong></h2></blockquote><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">DBHelper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre> <span class="token comment">//   给容器中自动创建出这两个类型的组件、默认组件的名字就是全类名</span></pre></td></tr></table></figure><blockquote><h2 id="conditional"><a class="anchor" href="#conditional">#</a> <strong>@Conditional</strong></h2></blockquote><p><strong>条件装配：满足 Conditional 指定的条件，则进行组件注入</strong></p><blockquote><h2 id="importresource"><a class="anchor" href="#importresource">#</a> <strong>@ImportResource</strong></h2></blockquote><p><strong>原生配置文件引入</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@ImportResource</span><span class="token punctuation">(</span><span class="token string">"classpath:beans.xml"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><h2 id="configurationproperties"><a class="anchor" href="#configurationproperties">#</a> <strong>@ConfigurationProperties</strong></h2></blockquote><p><strong>配置绑定，将 javabean 中的属性绑定到 properties 或 yml 文件中，可以通过配置文件修改 javabean 的属性值</strong></p><p><strong>参数：</strong></p><p><strong><code>prefix</code> : 在配置文件中通过参数来修改属性值</strong></p><blockquote><h2 id="enableconfigurationproperties"><a class="anchor" href="#enableconfigurationproperties">#</a> <strong>@EnableConfigurationProperties</strong></h2></blockquote><p><strong>相当于 @Component, 由于有时候需要在 spring 容器中创建第三方对象，不能在第三方对象中加入 @Component 注解，因此可以使用 @EnableConfigurationProperties (类名.class)</strong></p><h1 id="自动配置原理"><a class="anchor" href="#自动配置原理">#</a> 自动配置原理</h1><p><strong>在主程序的 @springbootApplication 注解内</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@SpringBootConfiguration</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token annotation punctuation">@EnableAutoConfiguration</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>		<span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>是由三个注解组合的.。</strong></p><ul><li><strong>@SpringBootConfiguration 代表当前是一个配置类</strong></li><li><strong>@ComponetScan 指定扫描那些 spring 注解</strong></li><li><strong>@EnableAutoConfiguration 从字面上理解是开启自动配置</strong></li></ul><p><strong>在 @EnableAutoConfiguration 中</strong></p><p><strong>还有两个注解</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@AutoConfigurationPackage</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span></pre></td></tr></table></figure><ul><li><strong>@AutoConfigurationPackage 自动配置包</strong></li></ul><p><strong>点击进去 里面还有一个注解</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationPackages<span class="token punctuation">.</span>Registrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>@Import 注解是向 Ioc 容器中导入一个组件，Registrar 是导入一系列组件</strong></p><ul><li><strong>Import (AutoConfigurationImportSelector.class) 是</strong></li></ul><p><strong>导入自动配置的选择器组件</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token number">1</span>、利用<span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>给容器中批量导入一些组件</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">2</span>、调用<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> configurations <span class="token operator">=</span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span>获取到所有需要导入到容器中的配置类</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">3</span>、利用工厂加载 <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">loadSpringFactories</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span>；得到所有的组件</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">4</span>、从META<span class="token operator">-</span>INF<span class="token operator">/</span>spring<span class="token punctuation">.</span>factories位置来加载一个文件。</pre></td></tr><tr><td data-num="5"></td><td><pre>    默认扫描我们当前系统里面所有META<span class="token operator">-</span>INF<span class="token operator">/</span>spring<span class="token punctuation">.</span>factories位置的文件</pre></td></tr><tr><td data-num="6"></td><td><pre>    spring<span class="token operator">-</span>boot<span class="token operator">-</span>autoconfigure<span class="token operator">-</span><span class="token number">2.3</span><span class="token number">.4</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar包里面也有META<span class="token operator">-</span>INF<span class="token operator">/</span>spring<span class="token punctuation">.</span>factories</pre></td></tr></table></figure><p><strong>在 springboot 的自动配置包中的 spring.factories 文件中已经写死了一启动就加载的所有配置类</strong></p><p><strong><img data-src="https://tva1.sinaimg.cn/large/008eGmZEgy1go2iosngnrj30y40b0abn.jpg" alt=""></strong></p><p><strong>虽然在 spring.factories 中的所有配置类都要加载。但是根据 @Conditional 注解按照条件装配规则，最终会按需配置。</strong></p><p><strong>在 dispatchServletAutoConfiguration 中，注册了 MultipartResolver 文件上传器</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Bean</span></pre></td></tr><tr><td data-num="2"></td><td><pre>		<span class="token annotation punctuation">@ConditionalOnBean</span><span class="token punctuation">(</span><span class="token class-name">MultipartResolver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>		<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token class-name">DispatcherServlet</span><span class="token punctuation">.</span>MULTIPART_RESOLVER_BEAN_NAME<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>		<span class="token keyword">public</span> <span class="token class-name">MultipartResolver</span> <span class="token function">multipartResolver</span><span class="token punctuation">(</span><span class="token class-name">MultipartResolver</span> resolver<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//// 给 @Bean 标注的方法传入了对象参数，这个参数的值就会从容器中找，防止有些用户配置的文件上传解析器不符合规范</span></pre></td></tr><tr><td data-num="5"></td><td><pre>			<span class="token comment">// Detect if the user has created a MultipartResolver but named it incorrectly</span></pre></td></tr><tr><td data-num="6"></td><td><pre>			<span class="token keyword">return</span> resolver<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> MULTIPART_RESOLVER_BEAN_NAME <span class="token operator">=</span> <span class="token string">"multipartResolver"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>根据两个 @Conditional 注解可以知道只要存在 MultipartResolver 这个类并且 IOC 容器中没有</strong></p><p><strong>id 为 DispatcherServlet.multipartResolver 的文件上传器，就会自动帮我们创建一个。</strong></p><p><strong>SpringBoot 默认会在底层配好所有的组件。但是如果用户自己配置了以用户的优先</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Bean</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">CharacterEncodingFilter</span> <span class="token function">characterEncodingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>自动配置原理的总结：</strong></p><p><strong>1.Springboot 服务一启动，就会在 springboot-autoconfigure 的 Mate-inf 目录下的 spring.factory 中加载所有配置类。</strong></p><p><strong>2. 每个配置类按照条件进行生效，每个自动配置类中的属性值都会跟从 xxxxproperties 里拿，而 xxxproperties 与 xml 或 yml 配置文件绑定。</strong></p><p><strong>3. 符合条件的配置类就会给 spring 容器中装配很多组件。因此组件的功能就有了。</strong></p><p><strong>注意：定义化配置</strong></p><ul><li><strong>自己创建配置类，用 @Bean 替换底层的组件</strong></li><li><strong>通过用配置文件去修改</strong></li></ul><h1 id="静态资源访问"><a class="anchor" href="#静态资源访问">#</a> 静态资源访问</h1><p><strong>只要静态资源放在类路径下： called <code>/static</code> (or <code>/public</code> or <code>/resources</code> or <code>/META-INF/resources</code></strong></p><p><strong>访问 ： 当前项目根路径 / + 静态资源名</strong></p><p><strong>原理： 静态映射 /</strong>。**</p><p><strong>请求进来，先去找 Controller 看能不能处理。不能处理的所有请求又都交给静态资源处理器。静态资源也找不到则响应 404 页面</strong></p><p><strong>在 yaml 配置文件中改变默认的静态资源路径</strong></p><figure class="highlight yaml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">spring</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token key atrule">mvc</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token key atrule">static-path-pattern</span><span class="token punctuation">:</span> /res/<span class="token important">**</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token key atrule">resources</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token key atrule">static-locations</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>classpath<span class="token punctuation">:</span>/haha/<span class="token punctuation">]</span></pre></td></tr></table></figure><h1 id="静态资源的自动配置原理"><a class="anchor" href="#静态资源的自动配置原理">#</a> 静态资源的自动配置原理</h1><p><strong>SpringMvc 功能的自动配置类为 <code>WebMvcAutoConfiguration</code></strong></p><p><strong>给容器中添加的组件</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">EnableWebMvcConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">// 加入了开启自动配置的组件</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token class-name">WebMvcProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>			<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>ResourceProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WebProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// 与 WebMvcProperties 和 ResourceProperties 绑定起来了</span></pre></td></tr></table></figure><p><strong>WebMvcProperties 和 ResourceProperties 又与 yaml 和 properties 配置绑定起来，可以通过 yaml 和 properties 文件修改两个类中的属性值。</strong></p><blockquote><h3 id="注意当配置类只有一个有参构造器时候参数里的值都是自动从容器中获取"><a class="anchor" href="#注意当配置类只有一个有参构造器时候参数里的值都是自动从容器中获取">#</a> <strong>注意：当配置类只有一个有参构造器时候，参数里的值都是自动从容器中获取。</strong></h3></blockquote><p><strong>在 WebProperties 类中已经写死了默认的静态资源路径</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> CLASSPATH_RESOURCE_LOCATIONS <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"classpath:/META-INF/resources/"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="2"></td><td><pre>				<span class="token string">"classpath:/resources/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/static/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/public/"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>		<span class="token comment">/**</span></pre></td></tr><tr><td data-num="5"></td><td><pre>		 * Locations of static resources. Defaults to classpath:[/META-INF/resources/,</pre></td></tr><tr><td data-num="6"></td><td><pre>		 * /resources/, /static/, /public/].</pre></td></tr><tr><td data-num="7"></td><td><pre>		 */</pre></td></tr><tr><td data-num="8"></td><td><pre>		<span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> staticLocations <span class="token operator">=</span> CLASSPATH_RESOURCE_LOCATIONS<span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">String</span> staticPathPattern <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getStaticPathPattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>registry<span class="token punctuation">.</span><span class="token function">hasMappingForPattern</span><span class="token punctuation">(</span>staticPathPattern<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>				<span class="token function">customizeResourceHandlerRegistration</span><span class="token punctuation">(</span>registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span>staticPathPattern<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>						<span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token function">getResourceLocations</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getStaticLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>						<span class="token punctuation">.</span><span class="token function">setCachePeriod</span><span class="token punctuation">(</span><span class="token function">getSeconds</span><span class="token punctuation">(</span>cachePeriod<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCacheControl</span><span class="token punctuation">(</span>cacheControl<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>						<span class="token punctuation">.</span><span class="token function">setUseLastModified</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isUseLastModified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>如果在配置文件中没有配置静态资源访问路径，默认就是配置 <code>classpath:/META-INF/resources/</code> , <code>classpath:/resources/</code> , <code>classpath:/static/</code> , <code>classpath:/public/</code> 四种访问路径。</strong></p><p><strong>静态资源访问前缀</strong></p><p><strong>默认无前缀</strong></p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">spring</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token key atrule">mvc</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token key atrule">static-path-pattern</span><span class="token punctuation">:</span> /res/<span class="token important">**</span></pre></td></tr></table></figure><p><strong>当前项目 + static-path-pattern + 静态资源名 = 静态资源文件夹下找</strong></p><h1 id="restful表单提交原理"><a class="anchor" href="#restful表单提交原理">#</a> Restful (表单提交) 原理</h1><ul><li><p><strong>表单提交会带上_method=PUT</strong></p></li><li><p><strong>请求过来被 HiddenHttpMethodFilter 拦截</strong></p></li><li><ul><li><strong>请求是否正常，并且是 POST</strong></li></ul></li><li><ul><li><ul><li><strong>获取到_method 的值。</strong></li><li><strong>兼容以下请求；PUT.DELETE.PATCH</strong></li><li><strong>原生 request（post），包装模式 requesWrapper 重写了 getMethod 方法，返回的是传入的值。</strong></li><li><strong>过滤器链放行的时候用 wrapper。以后的方法调用 getMethod 是调用 requesWrapper 的</strong></li></ul></li></ul></li></ul><p><strong>Rest 使用客户端工具，</strong></p><ul><li><strong>如 PostMan 直接发送 Put、delete 等方式请求，无需 Filter。</strong></li></ul><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">spring</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token key atrule">mvc</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token key atrule">hiddenmethod</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token key atrule">filter</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>   <span class="token comment">#开启页面表单的 Rest 功能</span></pre></td></tr></table></figure><h1 id="拦截器的原理"><a class="anchor" href="#拦截器的原理">#</a> 拦截器的原理</h1><p><strong>根据当前请求，找到 HandlerExecutionChain【可以处理请求的 handler 以及 handler 的所有 拦截器】</strong></p><p><strong>2、先来顺序执行 所有拦截器的 preHandle 方法</strong></p><ul><li><strong>1、如果当前拦截器 prehandler 返回为 true。则执行下一个拦截器的 preHandle</strong></li><li><strong>2、如果当前拦截器返回为 false。直接 倒序执行所有已经执行了的拦截器的 afterCompletion；</strong></li></ul><p><strong>3、如果任何一个拦截器返回 false。直接跳出不执行目标方法</strong></p><p><strong>4、所有拦截器都返回 True。执行目标方法</strong></p><p><strong>5、倒序执行所有拦截器的 postHandle 方法。</strong></p><p><strong>6、前面的步骤有任何异常都会直接倒序触发 afterCompletion</strong></p><p><strong>7、页面成功渲染完成以后，也会倒序触发 afterCompletion</strong></p><p><strong><img data-src="https://cdn.nlark.com/yuque/0/2020/png/1354552/1605765121071-64cfc649-4892-49a3-ac08-88b52fb4286f.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_10%2Ctext_YXRndWlndS5jb20g5bCa56GF6LC3%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></strong></p><p><strong>配置拦截器</strong></p><p><strong>1. 实现拦截器接口 <code>HandlerInterceptor</code></strong></p><p><strong>2. 重写接口中的方法</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> myinterceptor  <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token comment">// 目标方法执行之后 </span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 目标方法执行之前</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"拦截器开始工作了========="</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        </pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>3. 将写好的拦截器在 spring 容器中注册</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Configuration</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Myconfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">myinterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/css/**"</span><span class="token punctuation">,</span><span class="token string">"/fonts/**"</span><span class="token punctuation">,</span><span class="token string">"/images/**"</span><span class="token punctuation">,</span><span class="token string">"/js/**"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><h3 id="注意拦截器会拦截所有路径要保证静态资源和相应页面不被拦截"><a class="anchor" href="#注意拦截器会拦截所有路径要保证静态资源和相应页面不被拦截">#</a> <strong>注意：拦截器会拦截所有路径，要保证静态资源和相应页面不被拦截</strong></h3></blockquote><h1 id="文件上传原理"><a class="anchor" href="#文件上传原理">#</a> 文件上传原理</h1><blockquote><h4 id="文件上传自动配置类-multipartautoconfiguration-multipartpropertie"><a class="anchor" href="#文件上传自动配置类-multipartautoconfiguration-multipartpropertie">#</a> <strong>文件上传自动配置类 - MultipartAutoConfiguration-MultipartPropertie</strong></h4><ul><li><h4 id="自动配置好了-standardservletmultipartresolver-文件上传解析器"><a class="anchor" href="#自动配置好了-standardservletmultipartresolver-文件上传解析器">#</a> <strong>自动配置好了 StandardServletMultipartResolver 【文件上传解析器】</strong></h4></li><li><h4 id="原理步骤"><a class="anchor" href="#原理步骤">#</a> <strong>原理步骤</strong></h4></li><li><ul><li><strong>1、请求进来使用文件上传解析器判断（isMultipart）并封装（resolveMultipart，返回 MultipartHttpServletRequest）文件上传请求</strong></li><li><strong>2、参数解析器来解析请求中的文件内容封装成 MultipartFile</strong></li><li><strong>3、将 request 中文件信息封装为一个 Map；MultiValueMap&lt;String, MultipartFile&gt;</strong></li></ul></li></ul></blockquote><p><strong>FileCopyUtils。实现文件流的拷贝</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/upload"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> email<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                         <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>                         <span class="token annotation punctuation">@RequestPart</span><span class="token punctuation">(</span><span class="token string">"headerImg"</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> headerImg<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                         <span class="token annotation punctuation">@RequestPart</span><span class="token punctuation">(</span><span class="token string">"photos"</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> photos<span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>页面表单</strong></p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/upload<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p><strong>文件上传代码</strong></p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</span></pre></td></tr><tr><td data-num="2"></td><td><pre>     * MultipartFile 自动封装上传过来的文件</pre></td></tr><tr><td data-num="3"></td><td><pre>     * @param email</pre></td></tr><tr><td data-num="4"></td><td><pre>     * @param username</pre></td></tr><tr><td data-num="5"></td><td><pre>     * @param headerImg</pre></td></tr><tr><td data-num="6"></td><td><pre>     * @param photos</pre></td></tr><tr><td data-num="7"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="8"></td><td><pre>     */</pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/upload"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> email<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>                         <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                         <span class="token annotation punctuation">@RequestPart</span><span class="token punctuation">(</span><span class="token string">"headerImg"</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> headerImg<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                         <span class="token annotation punctuation">@RequestPart</span><span class="token punctuation">(</span><span class="token string">"photos"</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> photos<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"上传的信息：email=&#123;&#125;，username=&#123;&#125;，headerImg=&#123;&#125;，photos=&#123;&#125;"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                email<span class="token punctuation">,</span>username<span class="token punctuation">,</span>headerImg<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>photos<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>headerImg<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token comment">// 保存到文件服务器，OSS 服务器</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token class-name">String</span> originalFilename <span class="token operator">=</span> headerImg<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            headerImg<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"H:\\cache\\"</span><span class="token operator">+</span>originalFilename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>photos<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> photo <span class="token operator">:</span> photos<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>photo<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                    <span class="token class-name">String</span> originalFilename <span class="token operator">=</span> photo<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                    photo<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"H:\\cache\\"</span><span class="token operator">+</span>originalFilename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token keyword">return</span> <span class="token string">"main"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h1 id="异常处理"><a class="anchor" href="#异常处理">#</a> 异常处理</h1><ul><li><strong>默认处理</strong></li></ul><p><strong>默认情况下，Spring Boot 提供 <code>/error</code> 处理所有错误的映射</strong></p><p><strong>对于机器客户端，它将生成 JSON 响应，其中包含错误，HTTP 状态和异常消息的详细信息。对于浏览器客户端，响应一个 “whitelabel” 错误视图，以 HTML 格式呈现相同的数据</strong></p><p><strong>要对其进行自定义，添加</strong> <code>View</code> 解析为 <code>error</code> ****</p><p><strong>要完全替换默认行为，可以实现 <code>ErrorController</code> 并注册该类型的 Bean 定义，或添加 <code>ErrorAttributes类型的组件</code> 以使用现有机制但替换其内容。</strong></p><p><strong>error / 下的 4xx，5xx 页面会被自动解析；</strong></p><ul><li><strong>自定义错误页</strong></li><li><ul><li><strong>error/404.html error/5xx.html；有精确的错误状态码页面就匹配精确，没有就找 4xx.html；如果都没有就触发白页</strong></li></ul></li><li><strong>@ControllerAdvice+@ExceptionHandler 处理全局异常；底层是 ExceptionHandlerExceptionResolver 支持的</strong></li></ul><p>编写一个异常类</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wyh<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> helloexception <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token function">helloexception</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token function">helloexception</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>创建异常统一处理的类</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@ControllerAdvice</span><span class="token comment">// 控制器增强器</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> myhandle <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>helloexception<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">// 异常处理器，可以专门处理某个异常</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span><span class="token comment">//e 中保存异常的信息</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"ex"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>          <span class="token keyword">return</span> <span class="token string">"ex"</span><span class="token punctuation">;</span><span class="token comment">// 逻辑视图，经过视图解析器跳转到页面</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li><strong>@ResponseStatus + 自定义异常 ；底层是 ResponseStatusExceptionResolver ，把 responsestatus 注解的信息底层调用 response.sendError (statusCode, resolvedReason)；tomcat 发送的 /error</strong></li></ul><h1 id="视图解析原理"><a class="anchor" href="#视图解析原理">#</a> 视图解析原理</h1><p><strong>视图解析：</strong></p><ul><li><ul><li><strong>返回值以 forward: 开始： new InternalResourceView (forwardUrl); --&gt; 转发 request.getRequestDispatcher (path).forward (request, response);</strong></li><li><strong>返回值以</strong> <strong>redirect: 开始：</strong> <strong>new RedirectView () --》 render 就是重定向</strong></li><li><strong>返回值是普通字符串： new ThymeleafView（）---&gt;</strong></li></ul></li></ul><h1 id="本地测试"><a class="anchor" href="#本地测试">#</a> 本地测试</h1><blockquote><h2 id="引入依赖"><a class="anchor" href="#引入依赖">#</a> 引入依赖</h2></blockquote><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><blockquote><h2 id="启动测试类"><a class="anchor" href="#启动测试类">#</a> 启动测试类</h2></blockquote><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wyh<span class="token punctuation">.</span>myspringboot</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>convert<span class="token punctuation">.</span></span><span class="token class-name">Convert</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token annotation punctuation">@Slf4j</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token annotation punctuation">@SpringBootTest</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyspringbootApplicationTests</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token annotation punctuation">@Test</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"出现异常了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h1 id="日志处理"><a class="anchor" href="#日志处理">#</a> 日志处理</h1><blockquote><h1 id="引言"><a class="anchor" href="#引言">#</a> 引言</h1><figure class="highlight markdown"><figcaption data-lang="markdown"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> Logbac是由log4j创始人设计的又一个开源日志组件,目前,logback分为三个模块</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token list punctuation">-</span> logback-core</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token list punctuation">-</span> logback-classic</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token list punctuation">-</span> logback-access</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> 总结：logback也是一个开源日志组件,跟log4j作用是一致的,但是更加轻量</span></pre></td></tr></table></figure></blockquote><blockquote><h3 id="日志级别"><a class="anchor" href="#日志级别">#</a> 日志级别</h3></blockquote><figure class="highlight markdown"><figcaption data-lang="markdown"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> All &lt; Trace &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; Fatal &lt; OFF</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token list punctuation">-</span> OFF :关闭,最高级别,不打印日志</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token list punctuation">-</span> FATAL:致命:指明非常严重的可能会导致整个应用终止的错误</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token list punctuation">-</span> ERROR:错误:指明错误事件</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token list punctuation">-</span> WARN: 警告:指明可能潜在的危险状态</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token list punctuation">-</span> INFO :信息:指明描述信息</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token list punctuation">-</span> DEBUG:调试:指明细致的事件信息</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token list punctuation">-</span> TRACE:跟踪,指明程序运行轨迹</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token list punctuation">-</span> ALL:所有:所有日志级别</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token blockquote punctuation">></span> 日志级别由高到低 :  - 日志级别越高输出越多</pre></td></tr></table></figure><blockquote><h4 id="项目中的分类"><a class="anchor" href="#项目中的分类">#</a> 项目中的分类</h4></blockquote><figure class="highlight markdown"><figcaption data-lang="markdown"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> 日志分类</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token list punctuation">-</span> rootLogger :用来监听项目中所有的运行日志,包括引入依赖jar中的日志</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token list punctuation">-</span> logger:用来监听项目中指定包中的日志信息</pre></td></tr></table></figure><blockquote><h1 id="配置日志"><a class="anchor" href="#配置日志">#</a> 配置日志</h1><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">logging</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token key atrule">level</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre> <span class="token key atrule">root</span><span class="token punctuation">:</span> info <span class="token comment">#调整全局日志展示为 debug</span></pre></td></tr><tr><td data-num="4"></td><td><pre> <span class="token key atrule">com.wyh.mapper</span><span class="token punctuation">:</span> debug <span class="token comment">#输出指定包的日志级别</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token key atrule">file</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token key atrule">name</span><span class="token punctuation">:</span> run.log <span class="token comment">#日志文件的名称</span></pre></td></tr><tr><td data-num="7"></td><td><pre> <span class="token key atrule">path</span><span class="token punctuation">:</span> ./ <span class="token comment">#存储位置，./ 表示当前的项目</span></pre></td></tr></table></figure></blockquote><p><mark>注意:springboot 中的默认日志为 INFO</mark></p><h1 id="aop"><a class="anchor" href="#aop">#</a> AOP</h1><blockquote><h2 id="简介"><a class="anchor" href="#简介">#</a> 简介</h2></blockquote><figure class="highlight markdown"><figcaption data-lang="markdown"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> AOP :Aspect(切面) Oriented(面向) Programaing(面向切面编程)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> Aspect(切面)=Advice(通知) +切入点(Pointcut)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token list punctuation">-</span> Advice:通知,业务逻辑中一些附加操作称之为通知</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token list punctuation">-</span> Pointcut:切入点,配置通知应用于项目中那些业务操作</pre></td></tr></table></figure><blockquote><h1 id="引入依赖-2"><a class="anchor" href="#引入依赖-2">#</a> 引入依赖</h1><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></blockquote><blockquote><h2 id="创建一个切面类"><a class="anchor" href="#创建一个切面类">#</a> 创建一个切面类</h2></blockquote><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wyh<span class="token punctuation">.</span>aspect</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">JoinPoint</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Aspect</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Before</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token annotation punctuation">@Aspect</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token annotation punctuation">@Component</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAspect</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">/**</span></pre></td></tr><tr><td data-num="11"></td><td><pre>     *</pre></td></tr><tr><td data-num="12"></td><td><pre>     * @param joinPoint 连接点</pre></td></tr><tr><td data-num="13"></td><td><pre>     */</pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"execution(* com.wyh.service.*.*(..))"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li><p><code>@Aspect</code> : 只能作用在类上，代表是一个切面类</p></li><li><p><code>@Before</code> : 作用在方法上，前置通知</p></li><li><p><code>@After</code> : 作用在方法上，后置通知</p></li><li><p><code>@Around</code> : 作用在方法上，环绕通知</p></li></ul><blockquote><h3 id="注意如果使用around返回值必须是object"><a class="anchor" href="#注意如果使用around返回值必须是object">#</a> 注意：如果使用 Around, 返回值必须是 Object</h3><p>通过在参数列表中声明 JointPoint 连接点可以获取切入方法 的一些信息，并且参数为 ProceedingJoinPoint 必须执行放行，如果不放行就无法接收返回的数据。</p></blockquote><h1 id="cors跨域"><a class="anchor" href="#cors跨域">#</a> CORS 跨域</h1><blockquote><h1 id="简介-2"><a class="anchor" href="#简介-2">#</a> 简介</h1></blockquote><ul><li>CORS 是一个 W3C 标准，全称是跨域资源共享</li><li>它允许浏览器向跨源服务器，发出 XMLHttpRequest 请求，从而克服了 Ajax 只能同源使用的限制</li></ul><blockquote><h2 id="同源策略"><a class="anchor" href="#同源策略">#</a> 同源策略</h2></blockquote><ul><li><mark>同源策略</mark>：是浏览器的一个安全功能，不同源的客户端脚本在没有明确授权的情况下，不能读写对方资源，同源策略是浏览器安全的基石</li></ul><blockquote><h2 id="源"><a class="anchor" href="#源">#</a> 源</h2></blockquote><ul><li>源就是协议、域名、端口号</li></ul><blockquote><h2 id="同源"><a class="anchor" href="#同源">#</a> 同源</h2></blockquote><ul><li>若地址里面的协议、域名、端口号均相同则属于同源</li></ul><figure class="highlight markdown"><figcaption data-lang="markdown"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> 那些操作不会受到同源限制</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`&lt;script>&lt;srcipt/> &lt;img>`</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token title important"><span class="token punctuation">#</span> 哪些操作会受到同源限制</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token list punctuation">-</span> AJAX</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token list punctuation">-</span> 出现跨域:Access-Control-Allow-Origin</pre></td></tr></table></figure><blockquote><h2 id="全局解决跨域"><a class="anchor" href="#全局解决跨域">#</a> 全局解决跨域</h2></blockquote><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wyh<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span></span><span class="token class-name">CorsFilter</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">CorsRegistry</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token annotation punctuation">@Configuration</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CorsConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ORIGINS<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"POST"</span><span class="token punctuation">,</span> <span class="token string">"PUT"</span><span class="token punctuation">,</span> <span class="token string">"DELETE"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCorsMappings</span><span class="token punctuation">(</span><span class="token class-name">CorsRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        registry<span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span> <span class="token comment">// 所有的当前站点的请求地址，都支持跨域访问。</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                <span class="token punctuation">.</span><span class="token function">allowedHeaders</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                <span class="token punctuation">.</span><span class="token function">exposedHeaders</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                <span class="token function">allowedOriginPatterns</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span> <span class="token comment">// 所有的外部域都可跨域访问。 如果是 localhost 则很难配置，因为在跨域请求的时候，外部域的解析可能是 localhost、127.0.0.1、主机名</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                <span class="token punctuation">.</span><span class="token function">allowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 是否支持跨域用户凭证</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                <span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span>ORIGINS<span class="token punctuation">)</span> <span class="token comment">// 当前站点支持的跨域请求类型是什么</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                <span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 超时时长设置为 1 小时。 时间单位是秒。</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E6%A1%86%E6%9E%B6/" rel="tag"><i class="ic i-tag"></i> 框架</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-10-21 21:05:39" itemprop="dateModified" datetime="2021-10-21T21:05:39+08:00">2021-10-21</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>故犹 <i class="ic i-at"><em>@</em></i>努力走,走到灯火通明</li><li class="link"><strong>本文链接：</strong> <a href="https://guyouwyh.github.io/guyouwyh/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/Springboot%E7%AC%94%E8%AE%B0/" title="Springboot2.x笔记">https://guyouwyh.github.io/guyouwyh/2021/10/21/后端/Spring框架/Springboot笔记/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/SpringMVC3/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2021&#x2F;12&#x2F;15&#x2F;B735tDMiU2eZFjK.jpg" title="SpringMCV(三)"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Spring框架</span><h3>SpringMCV(三)</h3></a></div><div class="item right"><a href="/2021/10/21/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/redis/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2021&#x2F;12&#x2F;15&#x2F;7E2sYl8uZARyLqh.jpg" title="Redis笔记"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Redis</span><h3>Redis笔记</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%95%E5%B1%82%E6%B3%A8%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">底层注解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#configuration"><span class="toc-number">1.1.</span> <span class="toc-text">@Configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bean"><span class="toc-number">1.2.</span> <span class="toc-text">Bean</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#import"><span class="toc-number">1.3.</span> <span class="toc-text">@Import</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#conditional"><span class="toc-number">1.4.</span> <span class="toc-text">@Conditional</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#importresource"><span class="toc-number">1.5.</span> <span class="toc-text">@ImportResource</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#configurationproperties"><span class="toc-number">1.6.</span> <span class="toc-text">@ConfigurationProperties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enableconfigurationproperties"><span class="toc-number">1.7.</span> <span class="toc-text">@EnableConfigurationProperties</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">自动配置原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE"><span class="toc-number">3.</span> <span class="toc-text">静态资源访问</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9A%84%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">静态资源的自动配置原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E5%BD%93%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E6%9C%89%E5%8F%82%E6%9E%84%E9%80%A0%E5%99%A8%E6%97%B6%E5%80%99%E5%8F%82%E6%95%B0%E9%87%8C%E7%9A%84%E5%80%BC%E9%83%BD%E6%98%AF%E8%87%AA%E5%8A%A8%E4%BB%8E%E5%AE%B9%E5%99%A8%E4%B8%AD%E8%8E%B7%E5%8F%96"><span class="toc-number">4.0.1.</span> <span class="toc-text">注意：当配置类只有一个有参构造器时候，参数里的值都是自动从容器中获取。</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#restful%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E5%8E%9F%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">Restful (表单提交) 原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">6.</span> <span class="toc-text">拦截器的原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E6%8B%A6%E6%88%AA%E5%99%A8%E4%BC%9A%E6%8B%A6%E6%88%AA%E6%89%80%E6%9C%89%E8%B7%AF%E5%BE%84%E8%A6%81%E4%BF%9D%E8%AF%81%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%92%8C%E7%9B%B8%E5%BA%94%E9%A1%B5%E9%9D%A2%E4%B8%8D%E8%A2%AB%E6%8B%A6%E6%88%AA"><span class="toc-number">6.0.1.</span> <span class="toc-text">注意：拦截器会拦截所有路径，要保证静态资源和相应页面不被拦截</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8E%9F%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">文件上传原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%B1%BB-multipartautoconfiguration-multipartpropertie"><span class="toc-number">7.0.0.1.</span> <span class="toc-text">文件上传自动配置类 - MultipartAutoConfiguration-MultipartPropertie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%A5%BD%E4%BA%86-standardservletmultipartresolver-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="toc-number">7.0.0.2.</span> <span class="toc-text">自动配置好了 StandardServletMultipartResolver 【文件上传解析器】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%E6%AD%A5%E9%AA%A4"><span class="toc-number">7.0.0.3.</span> <span class="toc-text">原理步骤</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">异常处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86"><span class="toc-number">9.</span> <span class="toc-text">视图解析原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95"><span class="toc-number">10.</span> <span class="toc-text">本地测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">10.1.</span> <span class="toc-text">引入依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95%E7%B1%BB"><span class="toc-number">10.2.</span> <span class="toc-text">启动测试类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%A4%84%E7%90%86"><span class="toc-number">11.</span> <span class="toc-text">日志处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">12.</span> <span class="toc-text">引言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB"><span class="toc-number">12.0.1.</span> <span class="toc-text">日志级别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">12.0.1.1.</span> <span class="toc-text">项目中的分类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%97%A5%E5%BF%97"><span class="toc-number">13.</span> <span class="toc-text">配置日志</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#aop"><span class="toc-number">14.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">14.1.</span> <span class="toc-text">简介</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96-2"><span class="toc-number">15.</span> <span class="toc-text">引入依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%88%87%E9%9D%A2%E7%B1%BB"><span class="toc-number">15.1.</span> <span class="toc-text">创建一个切面类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E5%A6%82%E6%9E%9C%E4%BD%BF%E7%94%A8around%E8%BF%94%E5%9B%9E%E5%80%BC%E5%BF%85%E9%A1%BB%E6%98%AFobject"><span class="toc-number">15.1.1.</span> <span class="toc-text">注意：如果使用 Around, 返回值必须是 Object</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cors%E8%B7%A8%E5%9F%9F"><span class="toc-number">16.</span> <span class="toc-text">CORS 跨域</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="toc-number">17.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5"><span class="toc-number">17.1.</span> <span class="toc-text">同源策略</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90"><span class="toc-number">17.2.</span> <span class="toc-text">源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8C%E6%BA%90"><span class="toc-number">17.3.</span> <span class="toc-text">同源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F"><span class="toc-number">17.4.</span> <span class="toc-text">全局解决跨域</span></a></li></ol></li></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/Spring/" rel="bookmark" title="Spring5.x笔记">Spring5.x笔记</a></li><li><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/SpringMVC1/" rel="bookmark" title="SpringMCV(一)">SpringMCV(一)</a></li><li><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/SpringMVC2/" rel="bookmark" title="SpringMCV(二)">SpringMCV(二)</a></li><li><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/SpringMVC3/" rel="bookmark" title="SpringMCV(三)">SpringMCV(三)</a></li><li class="active"><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/Springboot%E7%AC%94%E8%AE%B0/" rel="bookmark" title="Springboot2.x笔记">Springboot2.x笔记</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="故犹" data-src="/images/avatar.jpg"><p class="name" itemprop="name">故犹</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">151</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">33</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">82</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2d1eW91d3lo" title="https:&#x2F;&#x2F;github.com&#x2F;guyouwyh"><i class="ic i-github"></i></span> <a href="/821403296@qq.com" title="821403296@qq.com" class="item email"><i class="ic i-envelope"></i></a></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-link"></i>友链</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-magic"></i>常用网站</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/Spring%E6%A1%86%E6%9E%B6/SpringMVC3/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/10/21/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/redis/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" title="分类于 动态规划">动态规划</a></div><span><a href="/2021/11/06/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2II/" title="【力扣】518.零钱兑换II">【力扣】518.零钱兑换II</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E5%A0%86/" title="分类于 堆">堆</a></div><span><a href="/2022/03/29/%E7%AE%97%E6%B3%95/%E5%A0%86/%E6%95%B0%E6%8D%AE%E6%B5%81%E4%B8%AD%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/" title="【牛客】JZ41 数据流中的中位数">【牛客】JZ41 数据流中的中位数</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6/" title="分类于 归并">归并</a></div><span><a href="/2022/03/31/%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6/%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84/" title="【力扣】合并两个有序数组">【力扣】合并两个有序数组</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%90%8E%E7%AB%AF/" title="分类于 后端">后端</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%90%8E%E7%AB%AF/JavaWeb/" title="分类于 JavaWeb">JavaWeb</a></div><span><a href="/2021/10/21/%E5%90%8E%E7%AB%AF/JavaWeb/Thymeleaf/" title="Thymeleaf模板引擎基本使用">Thymeleaf模板引擎基本使用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E8%B4%AA%E5%BF%83/" title="分类于 贪心">贪心</a></div><span><a href="/2021/10/27/%E7%AE%97%E6%B3%95/%E8%B4%AA%E5%BF%83/%E8%B7%B3%E8%B7%83%E6%B8%B8%E6%88%8F/" title="【力扣】55.跳跃游戏">【力扣】55.跳跃游戏</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E6%A8%A1%E6%8B%9F/" title="分类于 模拟">模拟</a></div><span><a href="/2022/04/01/%E7%AE%97%E6%B3%95/%E6%A8%A1%E6%8B%9F/%E8%8D%B7%E5%85%B0%E5%9B%BD%E6%97%97%E9%97%AE%E9%A2%98/" title="【力扣】 颜色分类">【力扣】 颜色分类</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%90%8E%E7%AB%AF/" title="分类于 后端">后端</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%90%8E%E7%AB%AF/Java/" title="分类于 Java基础">Java基础</a></div><span><a href="/2021/10/20/%E5%90%8E%E7%AB%AF/Java/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1(%E4%BA%8C)/" title="Java面向对象(二)">Java面向对象(二)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E6%90%9C%E7%B4%A2/" title="分类于 搜索">搜索</a></div><span><a href="/2022/02/01/%E7%AE%97%E6%B3%95/%E6%90%9C%E7%B4%A2/Corn%20Maze%20S/" title="【洛谷】P1825 [USACO11OPEN]Corn Maze S">【洛谷】P1825 [USACO11OPEN]Corn Maze S</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E8%B4%AA%E5%BF%83/" title="分类于 贪心">贪心</a></div><span><a href="/2021/10/27/%E7%AE%97%E6%B3%95/%E8%B4%AA%E5%BF%83/%E6%9C%80%E4%BD%B3%E8%A7%82%E5%85%89%E7%BB%84%E5%90%88/" title="【力扣】1014.最佳观光组合">【力扣】1014.最佳观光组合</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AE%97%E6%B3%95/" title="分类于 算法">算法</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6/" title="分类于 归并">归并</a></div><span><a href="/2022/02/24/%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6/%E9%80%86%E5%BA%8F%E5%AF%B9/" title="【洛谷】P1908 逆序对">【洛谷】P1908 逆序对</a></span></li></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">故犹 @ GuYou</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">519k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">7:52</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/10/21/后端/Spring框架/Springboot笔记/",favicon:{show:"加载中",hide:"OvO"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->